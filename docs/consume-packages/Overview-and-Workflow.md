---
title: 使用 NuGet 套件的概觀和工作流程
description: 在專案中使用 NuGet 套件之程序的概觀，以及程序之其他特定部分的連結。
author: karann-msft
ms.author: karann
ms.date: 03/22/2018
ms.topic: conceptual
ms.openlocfilehash: ddd1d163e18ed4ce1e7cbf41ed152acc40c1c423
ms.sourcegitcommit: 2b50c450cca521681a384aa466ab666679a40213
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/07/2020
ms.locfileid: "79428881"
---
# <a name="package-consumption-workflow"></a><span data-ttu-id="98e94-103">套件使用工作流程</span><span class="sxs-lookup"><span data-stu-id="98e94-103">Package consumption workflow</span></span>

<span data-ttu-id="98e94-104">在 nuget.org 與您組織可建立的私人套件庫之間，您可以找到數以萬計的高可用套件，以在您的應用程式和服務中使用。</span><span class="sxs-lookup"><span data-stu-id="98e94-104">Between nuget.org and private package galleries that your organization might establish, you can find tens of thousands of highly useful packages to use in your apps and services.</span></span> <span data-ttu-id="98e94-105">但是不論來源為何，使用套件會遵循相同的一般工作流程。</span><span class="sxs-lookup"><span data-stu-id="98e94-105">But regardless of the source, consuming a package follows the same general workflow.</span></span>

![移至套件來源、尋找套件、將它安裝至專案，然後新增 using 陳述式和套件 API 呼叫的流程](media/Overview-01-GeneralFlow.png)

<span data-ttu-id="98e94-107">\*_視覺工作室和`dotnet.exe`唯一。該`nuget install`指令不修改專案檔或檔`packages.config`; 否則,命令將不修改專案檔或檔。必須手動管理條目。_</span><span class="sxs-lookup"><span data-stu-id="98e94-107">\* _Visual Studio and `dotnet.exe` only. The `nuget install` command does not modify project files or the `packages.config` file; entries must be managed manually._</span></span>

<span data-ttu-id="98e94-108">如需詳細資料，請參閱[尋找及選擇套件](../consume-packages/finding-and-choosing-packages.md)和[安裝套件後會發生什麼事](../concepts/package-installation-process.md)。</span><span class="sxs-lookup"><span data-stu-id="98e94-108">For further details, see [Finding and Choosing Packages](../consume-packages/finding-and-choosing-packages.md) and [What happens when a package is installed?](../concepts/package-installation-process.md).</span></span>

<span data-ttu-id="98e94-109">NuGet 會記住每個已安裝套件的身分識別和版本號碼，並將其記錄在專案檔 (使用 [PackageReference](../consume-packages/package-references-in-project-files.md)) 或 [`packages.config`](../reference/packages-config.md) 中，端視專案類型和 NuGet 版本而定。</span><span class="sxs-lookup"><span data-stu-id="98e94-109">NuGet remembers the identity and version number of each installed package, recording it in either the project file (using [PackageReference](../consume-packages/package-references-in-project-files.md)) or [`packages.config`](../reference/packages-config.md), depending on project type and your version of NuGet.</span></span> <span data-ttu-id="98e94-110">使用 NuGet 4.0+ 時，儘管可在 Visual Studio 中透過[套件管理員 UI ](install-use-packages-visual-studio.md)來設定，但最好是使用 PackageReference。</span><span class="sxs-lookup"><span data-stu-id="98e94-110">With NuGet 4.0+, PackageReference is preferred, although this is configurable in Visual Studio through the [Package Manager UI](install-use-packages-visual-studio.md).</span></span> <span data-ttu-id="98e94-111">在任何情況下，您隨時都可以查看適當的檔案，以查看您專案的完整相依性清單。</span><span class="sxs-lookup"><span data-stu-id="98e94-111">In any case, you can look in the appropriate file at any time to see the full list of dependencies for your project.</span></span>

> [!Tip]
> <span data-ttu-id="98e94-112">最好一律檢查您要在軟體中使用之每個套件的授權。</span><span class="sxs-lookup"><span data-stu-id="98e94-112">It's prudent to always check the license for each package you intend to use in your software.</span></span> <span data-ttu-id="98e94-113">在 nuget.org 上，您可以在每個套件的描述頁面右側找到 [授權資訊]\*\*\*\* 連結。</span><span class="sxs-lookup"><span data-stu-id="98e94-113">On nuget.org, you find a **License Info** link on the right side of each package's description page.</span></span> <span data-ttu-id="98e94-114">如果套件未指定授權條款，請使用套件頁面上的 [連絡擁有者]\*\*\*\* 連結直接連絡套件擁有者。</span><span class="sxs-lookup"><span data-stu-id="98e94-114">If a package does not specify license terms, contact the package owner directly using the **Contact owners** link on the package page.</span></span> <span data-ttu-id="98e94-115">Microsoft 不會將任何智慧財產權從協力廠商套件提供者授權給您，而且不負責協力廠商所提供的資訊。</span><span class="sxs-lookup"><span data-stu-id="98e94-115">Microsoft does not license any intellectual property to you from third party package providers and is not responsible for information provided by third parties.</span></span>

<span data-ttu-id="98e94-116">安裝套件時，NuGet 通常會檢查是否已經可以從其快取中使用套件。</span><span class="sxs-lookup"><span data-stu-id="98e94-116">When installing packages, NuGet typically checks if the package is already available from its cache.</span></span> <span data-ttu-id="98e94-117">您可以從命令列手動清除此快取，如[管理全域套件和快取資料夾](../consume-packages/managing-the-global-packages-and-cache-folders.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="98e94-117">You can manually clear this cache from the command line, as described on [Managing the global packages and cache folders](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span></span>

<span data-ttu-id="98e94-118">NuGet 也會確保套件所支援的目標架構與您的專案相容。</span><span class="sxs-lookup"><span data-stu-id="98e94-118">NuGet also makes sure that the target frameworks supported by the package are compatible with your project.</span></span> <span data-ttu-id="98e94-119">如果套件未包含相容的組件，則 NuGet 會顯示錯誤。</span><span class="sxs-lookup"><span data-stu-id="98e94-119">If the package does not contain compatible assemblies, NuGet displays an error.</span></span> <span data-ttu-id="98e94-120">請參閱[解決不相容的套件錯誤](../concepts/dependency-resolution.md#resolving-incompatible-package-errors)。</span><span class="sxs-lookup"><span data-stu-id="98e94-120">See [Resolving incompatible package errors](../concepts/dependency-resolution.md#resolving-incompatible-package-errors).</span></span>

<span data-ttu-id="98e94-121">將專案程式碼新增至來源存放庫時，您通常不會包含 NuGet 套件。</span><span class="sxs-lookup"><span data-stu-id="98e94-121">When adding project code to a source repository, you typically don't include NuGet packages.</span></span> <span data-ttu-id="98e94-122">如果人員稍後複製存放庫或取得專案，其中包含 Visual Studio Team Services 這類系統上組建代理程式，則必須先還原必要套件，再執行組建置：</span><span class="sxs-lookup"><span data-stu-id="98e94-122">Those who later clone the repository or otherwise acquire the project, including build agents on systems like Visual Studio Team Services, must restore the necessary packages prior to running a build:</span></span>

![複製存放庫並使用還原命令來還原 NuGet 套件的流程](media/Overview-02-RestoreFlow.png)

<span data-ttu-id="98e94-124">[套件還原](../consume-packages/package-restore.md)使用專案檔或 `packages.config` 中的資訊來重新安裝所有相依性。</span><span class="sxs-lookup"><span data-stu-id="98e94-124">[Package Restore](../consume-packages/package-restore.md) uses the information in the project file or `packages.config` to reinstall all dependencies.</span></span> <span data-ttu-id="98e94-125">請注意，所含的程序會有些差異，如[相依性解析](../concepts/dependency-resolution.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="98e94-125">Note that there are differences in the process involved, as described in [Dependency Resolution](../concepts/dependency-resolution.md).</span></span> <span data-ttu-id="98e94-126">此外，上圖並沒有顯示套件管理員主控台的還原命令，原因是如果您在使用主控台，就代表您已經在使用 Visual Studio，它通常會自動還原套件並提供如同圖示的解決方案層級命令。</span><span class="sxs-lookup"><span data-stu-id="98e94-126">Also, the diagram above does not show a restore command for the Package Manager Console because if you're with the Console you're already in the context of Visual Studio, which typically restores packages automatically and provides the solution-level command as shown.</span></span>

<span data-ttu-id="98e94-127">偶爾需要重新安裝已包含在專案中的套件，這也可能會重新安裝相依性。</span><span class="sxs-lookup"><span data-stu-id="98e94-127">Occasionally it's necessary to reinstall packages that are already included in a project, which may also reinstall dependencies.</span></span> <span data-ttu-id="98e94-128">使用 `nuget reinstall` 命令或 NuGet 套件管理員主控台，就可以輕鬆做到這項作業。</span><span class="sxs-lookup"><span data-stu-id="98e94-128">This is easy to do using the `nuget reinstall` command or the NuGet Package Manager Console.</span></span> <span data-ttu-id="98e94-129">如需詳細資料，請參閱[重新安裝和更新套件](../consume-packages/reinstalling-and-updating-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="98e94-129">For details, see [Reinstalling and Updating Packages](../consume-packages/reinstalling-and-updating-packages.md).</span></span>

<span data-ttu-id="98e94-130">最後，NuGet 的行為是透過 `Nuget.Config` 檔案所驅動。</span><span class="sxs-lookup"><span data-stu-id="98e94-130">Finally, NuGet's behavior is driven by `Nuget.Config` files.</span></span> <span data-ttu-id="98e94-131">可以使用多個檔案來集中管理不同層級的特定設定，如[設定 NuGet 行為](../consume-packages/configuring-nuget-behavior.md)所述。</span><span class="sxs-lookup"><span data-stu-id="98e94-131">Multiple files can be used to centralize certain settings at different levels, as explained in [Configuring NuGet Behavior](../consume-packages/configuring-nuget-behavior.md).</span></span>

## <a name="ways-to-install-a-nuget-package"></a><span data-ttu-id="98e94-132">安裝 NuGet 套件的方式</span><span class="sxs-lookup"><span data-stu-id="98e94-132">Ways to install a NuGet Package</span></span>

<span data-ttu-id="98e94-133">NuGet 套件會使用下表任一方法下載並安裝。</span><span class="sxs-lookup"><span data-stu-id="98e94-133">NuGet packages are downloaded and installed using any of the methods in the following table.</span></span>

| <span data-ttu-id="98e94-134">工具</span><span class="sxs-lookup"><span data-stu-id="98e94-134">Tool</span></span> | <span data-ttu-id="98e94-135">描述</span><span class="sxs-lookup"><span data-stu-id="98e94-135">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="98e94-136">點網.exe CLI</span><span class="sxs-lookup"><span data-stu-id="98e94-136">dotnet.exe CLI</span></span>](install-use-packages-dotnet-cli.md) | <span data-ttu-id="98e94-137">適用於 .NET Core 與 .NET Standard 程式庫，以及適用於以 .NET Framework 為目標的 SDK 樣式專案 CLI 工具 (請參閱 [ SDK 屬性](/dotnet/core/tools/csproj#additions))。</span><span class="sxs-lookup"><span data-stu-id="98e94-137">(All platforms) CLI tool for .NET Core and .NET Standard libraries, and for SDK-style projects that target .NET Framework (see [SDK attribute](/dotnet/core/tools/csproj#additions)).</span></span> <span data-ttu-id="98e94-138">擷取依 \<套件名稱\> 識別的套件，並新增參考至專案檔。</span><span class="sxs-lookup"><span data-stu-id="98e94-138">Retrieves the package identified by \<package_name\> and adds a reference to the project file.</span></span> <span data-ttu-id="98e94-139">此外，也會擷取並安裝相依性。</span><span class="sxs-lookup"><span data-stu-id="98e94-139">Also retrieves and installs dependencies.</span></span> |
| <span data-ttu-id="98e94-140">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="98e94-140">Visual Studio</span></span> | <span data-ttu-id="98e94-141">(Windows 和 Mac) 提供 UI，透過該 UI 可從指定套件來源瀏覽、選取套件及其相依性並安裝至專案。</span><span class="sxs-lookup"><span data-stu-id="98e94-141">(Windows and Mac) Provides a UI through which you can browse, select, and install packages and their dependencies into a project from a specified package source.</span></span> <span data-ttu-id="98e94-142">將對於已安裝套件的參考新增至專案檔。</span><span class="sxs-lookup"><span data-stu-id="98e94-142">Adds references to installed packages to the project file.</span></span><ul><li>[<span data-ttu-id="98e94-143">使用 Visual Studio 安裝和管理套件</span><span class="sxs-lookup"><span data-stu-id="98e94-143">Install and manage packages using Visual Studio</span></span>](install-use-packages-visual-studio.md)</li><li>[<span data-ttu-id="98e94-144">在專案中包含 NuGet 套件 (Mac)</span><span class="sxs-lookup"><span data-stu-id="98e94-144">Including a NuGet package in your project (Mac)</span></span>](/visualstudio/mac/nuget-walkthrough)</li></ul> |
| [<span data-ttu-id="98e94-145">套件管理員主控台 (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="98e94-145">Package Manager Console (Visual Studio)</span></span>](install-use-packages-powershell.md) | <span data-ttu-id="98e94-146">(僅限 Windows) 從所選來源擷取 \<package_name\> 所識別的套件並安裝到方案中的指定專案，然後將參考新增到專案檔。</span><span class="sxs-lookup"><span data-stu-id="98e94-146">(Windows only) Retrieves and installs the package identified by \<package_name\> from a selected source into a specified project in the solution, then adds a reference to the project file.</span></span> <span data-ttu-id="98e94-147">此外，也會擷取並安裝相依性。</span><span class="sxs-lookup"><span data-stu-id="98e94-147">Also retrieves and installs dependencies.</span></span> |
| [<span data-ttu-id="98e94-148">nuget.exe CLI</span><span class="sxs-lookup"><span data-stu-id="98e94-148">nuget.exe CLI</span></span>](install-use-packages-nuget-cli.md) | <span data-ttu-id="98e94-149">(所有平台) 適用於 .NET Framework 程式庫及以 .NET Standard 程式庫為目標的非 SDK 樣式專案 CLI 工具。</span><span class="sxs-lookup"><span data-stu-id="98e94-149">(All platforms) CLI tool for .NET Framework libraries and non-SDK-style projects that target .NET Standard libraries.</span></span> <span data-ttu-id="98e94-150">擷取依 \<套件名稱\> 識別的套件，並在目前目錄的資料夾中展開其內容；也可以擷取 `packages.config` 檔案中列出的所有套件。</span><span class="sxs-lookup"><span data-stu-id="98e94-150">Retrieves the package identified by \<package_name\> and expands its contents into a folder in the current directory; can also retrieve all packages listed in a `packages.config` file.</span></span> <span data-ttu-id="98e94-151">另外也會擷取並安裝相依性，但不會對專案檔或 `packages.config` 進行任何變更。</span><span class="sxs-lookup"><span data-stu-id="98e94-151">Also retrieves and installs dependencies, but makes no changes to project files or `packages.config`.</span></span> |
